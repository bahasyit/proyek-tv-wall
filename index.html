<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Display Lobi Utama</title>
    <style>
        body, html { margin: 0; padding: 0; height: 100%; width: 100%; overflow: hidden; }
        #view-container { width: 100%; height: 100%; position: relative; }
        #view-frame { width: 100%; height: 100%; border: none; }
        
        /* (CSS Tombol Start Anda) */
        #start-overlay {
            position: fixed; top: 0; left: 0;
            width: 100%; height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: flex; justify-content: center; align-items: center;
            z-index: 9999;
        }
        #start-button {
            padding: 25px 50px; font-size: 2vw; font-weight: bold;
            color: #333; background-color: #f0f0f0;
            border: none; border-radius: 10px; cursor: pointer;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            transition: all 0.2s ease;
        }
        #start-button:hover { background-color: #ffffff; transform: scale(1.05); }
    </style>
</head>
<body>

    <div id="start-overlay">
        <button id="start-button">KLIK UNTUK MEMULAI DISPLAY</button>
    </div>

    <div id="view-container">
        <iframe 
            id="view-frame" 
            src="about:blank" 
            allow="autoplay; fullscreen; encrypted-media; picture-in-picture"
        ></iframe>
        </div>

    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

    <script>
        // --- 1. Konfigurasi Firebase ---
        const firebaseConfig = {
          apiKey: "AIzaSyDnl0AJU10tBXze8u4nDdZoaAUFo8ypFiQ",
          authDomain: "project-tv-wall.firebaseapp.com",
          databaseURL: "https://project-tv-wall-default-rtdb.asia-southeast1.firebasedatabase.app",
          projectId: "project-tv-wall",
          // ... (Sisanya) ...
        };
        
        firebase.initializeApp(firebaseConfig);
        const database = firebase.database();
        const refConfig = database.ref('config/tampilan_aktif'); 

        // --- 2. Elemen "Cangkang" ---
        const elViewFrame = document.getElementById('view-frame');
        const elStartOverlay = document.getElementById('start-overlay');
        const elStartButton = document.getElementById('start-button');
        
        let tampilanAktifSekarang = ""; 

        // --- 3. Fungsi Helper untuk ganti tampilan ---
        function gantiTampilan(namaTampilan) {
            if (!namaTampilan || namaTampilan === tampilanAktifSekarang) {
                return;
            }
            console.log('Perintah diterima: Ganti tampilan ke ->', namaTampilan);
            tampilanAktifSekarang = namaTampilan;
            
            let urlTampilanBaru = '';
            if (namaTampilan === 'antrian') urlTampilanBaru = 'view_antrian.html';
            else if (namaTampilan === 'iklan') urlTampilanBaru = 'view_iklan.html';
            else urlTampilanBaru = 'view_antrian.html'; // Default

            elViewFrame.src = urlTampilanBaru;
        }

        // --- 4. Pendengar (Listener) Utama ---
        function setupConfigListener() {
            refConfig.on('value', (snapshot) => {
                const tampilanBaru = snapshot.val();
                gantiTampilan(tampilanBaru);
            });
        }

        // --- 5. Cek Tampilan Awal ---
        function loadInitialView() {
            refConfig.once('value', (snapshot) => {
                let tampilanAwal = 'antrian'; 
                if (snapshot.exists()) {
                    tampilanAwal = snapshot.val();
                } else {
                    refConfig.set(tampilanAwal); 
                }
                gantiTampilan(tampilanAwal);
            });
        }
        
        // --- 6. LOGIKA Tombol Start ---
        elStartButton.onclick = function() {
            elStartOverlay.style.display = 'none';
            elViewFrame.src = "about:blank"; // Muat dummy page
            loadInitialView();
            setupConfigListener();
        }
    </script>
</body>
</html>